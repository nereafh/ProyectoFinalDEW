<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mundo Mascota - Tienda Online</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="plantilla/css/styles.css">
    <script src="https://unpkg.com/vue@3"></script>
</head>
<body>

<div id="app">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#" @click.prevent="irAInicio">
                <img src="img/logo.png" alt="Logo" id="logo" class="d-inline-block align-text-top">
            </a>
            
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#" @click.prevent="irAInicio">Inicio</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link" href="#" @click.prevent="menuAbierto = !menuAbierto">Productos â–¼</a>
                        <ul id="lista-desplegable" v-show="menuAbierto">
                            <li><a class="item-categoria" href="#" @click.prevent="seleccionarCategoria('prod-camas')">Camas</a></li>
                            <li><a class="item-categoria" href="#" @click.prevent="seleccionarCategoria('prod-higiene-item')">Higiene</a></li>
                            <li><a class="item-categoria" href="#" @click.prevent="seleccionarCategoria('prod-juguetes')">Juguetes</a></li>
                            <li><a class="item-categoria" href="#" @click.prevent="seleccionarCategoria('prod-accesorios')">Accesorios</a></li>
                            <li><a class="item-categoria" href="#" @click.prevent="seleccionarCategoria('prod-comida')">AlimentaciÃ³n</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" @click.prevent="vistaActual = 'acerca'">Acerca de</a>
                    </li>
                </ul>

                <div class="d-flex align-items-center">
                    <template v-if="usuario">
                        <button class="btn btn-outline-light me-2" @click="vistaActual = 'carrito'">ðŸ›’ ({{carrito.length}})</button>
                        <span class="text-white me-2">{{ usuario }}</span>
                        <button class="btn btn-sm btn-outline-danger" @click="cerrarSesion">Salir</button>
                    </template>
                    <template v-else>
                        <button class="btn btn-outline-light me-2" @click="vistaActual = 'auth'">ðŸ‘¤ Entrar</button>
                    </template>

                    <select id="selector-idioma" class="form-select form-select-sm ms-2" style="width: auto;">
                        <option value="es">ES</option>
                        <option value="en">EN</option>
                    </select>
                </div>
            </div>
        </div>
    </nav>

    <div class="carousel-container" v-if="vistaActual === 'inicio' && catSeleccionada === 'all'">
        <div class="carousel-track" :style="{ transform: `translateX(-${indexCarrusel * 100}%)`, transition: 'transform 0.5s ease-in-out' }">
            <div class="slide" v-for="(img, i) in imagenesCarrusel" :key="i">
                <img :src="img.src" :id="img.id" @click="verDetalleProducto(img.id)" style="cursor:pointer">
            </div>
        </div>
        <button class="prev" @click="anteriorCarrusel"><</button>
        <button class="next" @click="siguienteCarrusel">></button>
    </div>

    <hr class="solid" v-if="vistaActual === 'inicio'">

    <main id="main-content" class="container my-5">
        
        <div v-if="vistaActual === 'inicio'">
            <div class="seccion-prod">
                <h1>{{ catSeleccionada === 'all' ? 'Productos Recomendados' : 'CategorÃ­a Seleccionada' }}</h1>
            </div>

            <div class="d-flex flex-wrap justify-content-center gap-4">
                <div class="prod-item" v-show="catSeleccionada === 'all' || catSeleccionada === 'prod-camas'">
                    <h2>Camas</h2>
                    <img src="img/cama1.jpg" alt="Cama">
                    <button @click="agregarAlCarrito({Nombre:'Cama Confort', precio: 35.0, imagen:'img/cama1.jpg'})" class="btn btn-dark btn-sm mt-2">AÃ±adir ðŸ›’</button>
                </div>

                <div class="prod-item prod-higiene-item" v-show="catSeleccionada === 'all' || catSeleccionada === 'prod-higiene-item'">
                    <h2>Higiene 1</h2>
                    <img src="img/higiene1.jpg" alt="Higiene">
                    <button @click="agregarAlCarrito({Nombre:'ChampÃº Perro', precio: 12.5, imagen:'img/higiene1.jpg'})" class="btn btn-dark btn-sm mt-2">AÃ±adir ðŸ›’</button>
                </div>

                <div class="prod-item prod-higiene-item" v-show="catSeleccionada === 'all' || catSeleccionada === 'prod-higiene-item'">
                    <h2>Higiene 2</h2>
                    <img src="img/higiene2.jpg" alt="Higiene">
                    <button @click="agregarAlCarrito({Nombre:'Colonia Mascota', precio: 10.0, imagen:'img/higiene2.jpg'})" class="btn btn-dark btn-sm mt-2">AÃ±adir ðŸ›’</button>
                </div>

                <div class="prod-item" v-show="catSeleccionada === 'all' || catSeleccionada === 'prod-juguetes'">
                    <h2>Juguetes</h2>
                    <img src="img/juguete2.jpg" alt="Juguete">
                    <button @click="agregarAlCarrito({Nombre:'Juguete Pelota', precio: 8.0, imagen:'img/juguete1.jpg'})" class="btn btn-dark btn-sm mt-2">AÃ±adir ðŸ›’</button>
                </div>

                <div class="prod-item" v-show="catSeleccionada === 'all' || catSeleccionada === 'prod-accesorios'">
                    <h2>Accesorios</h2>
                    <img src="img/accesorio1.jpg" alt="Accesorio">
                    <button @click="agregarAlCarrito({Nombre:'Correa Ajustable', precio: 15.0, imagen:'img/accesorio1.jpg'})" class="btn btn-dark btn-sm mt-2">AÃ±adir ðŸ›’</button>
                </div>

                <div class="prod-item" v-show="catSeleccionada === 'all' || catSeleccionada === 'prod-comida'">
                    <h2>AlimentaciÃ³n</h2>
                    <img src="img/comida1.jpg" alt="Comida">
                    <button @click="agregarAlCarrito({Nombre:'Comida Premium', precio: 25.0, imagen:'img/comida1.jpg'})" class="btn btn-dark btn-sm mt-2">AÃ±adir ðŸ›’</button>
                </div>
            </div>
        </div>

        <section v-if="vistaActual === 'detalle'" class="row">
            <div class="col-md-6 text-center">
                <img :src="productoSeleccionado.imagen" class="img-fluid rounded border">
            </div>
            <div class="col-md-6">
                <h2>{{ productoSeleccionado.nombre }}</h2>
                <p class="lead">{{ productoSeleccionado.descripcion }}</p>
                <h3 class="text-success">{{ productoSeleccionado.precio }}â‚¬</h3>
                <button class="btn btn-dark mt-3" @click="agregarAlCarrito(productoSeleccionado)">AÃ±adir al carrito</button>
                <button class="btn btn-outline-secondary mt-3 ms-2" @click="vistaActual = 'inicio'">Volver</button>
            </div>
        </section>

        <section v-if="vistaActual === 'carrito'" class="col-12">
            <h2>Tu Carrito ðŸ›’</h2>
            <div v-if="carrito.length === 0" class="alert alert-info">El carrito estÃ¡ vacÃ­o.</div>
            <div v-else>
                <table class="table align-middle">
                    <thead>
                        <tr><th>Producto</th><th>Precio</th><th>Cantidad</th><th>Subtotal</th><th>Acciones</th></tr>
                    </thead>
                    <tbody>
                        <tr v-for="(item, index) in carrito" :key="index">
                            <td>{{ item.Nombre }}</td>
                            <td>{{ item.precio }}â‚¬</td>
                            <td>{{ item.cantidad }}</td>
                            <td>{{ (item.precio * item.cantidad).toFixed(2) }}â‚¬</td>
                            <td><button class="btn btn-danger btn-sm" @click="eliminarDelCarrito(index)">Eliminar</button></td>
                        </tr>
                    </tbody>
                </table>
                <h4 class="text-end">Total: {{ totalFactura }}â‚¬</h4>
                <div class="d-flex justify-content-end">
                    <button class="btn btn-success btn-lg" @click="confirmarPedido">Confirmar Compra</button>
                </div>
            </div>
        </section>

        <div v-if="vistaActual === 'acerca'" class="seccion-acerca-de" style="display:block">
            <h3>Sobre Mundo Mascota</h3>
            <p>Mundo Mascota naciÃ³ en 2024 con una misiÃ³n clara: ofrecer a nuestros compaÃ±eros de cuatro patas solo lo mejor.</p>
            <p><strong>Nuestros valores:</strong> Calidad, compromiso y amor por la biodiversidad.</p>
            <button class="btn btn-dark" @click="vistaActual = 'inicio'">Volver al inicio</button>
        </div>

        <div v-if="vistaActual === 'auth'" class="estFormulario" style="display:flex">
            <div v-if="authVista === 'menu'" class="text-center">
                <button class="btn btn-dark mb-2 w-100" @click="authVista = 'login'">Iniciar SesiÃ³n</button>
                <button class="btn btn-outline-dark w-100" @click="authVista = 'registro'">Registrarse</button>
                <button class="btn btn-link mt-3" @click="vistaActual = 'inicio'">Cancelar</button>
            </div>

            <div v-if="authVista === 'login'" class="w-100 p-4 border rounded">
                <h4>Iniciar SesiÃ³n</h4>
                <p class="text-danger">{{ errorMsgLogin }}</p>
                <input type="email" v-model="formLogin.email" class="form-control mb-2" placeholder="Email">
                <input type="password" v-model="formLogin.pass" class="form-control mb-3" placeholder="ContraseÃ±a">
                <button class="btn btn-dark w-100" @click="ejecutarLogin">Entrar</button>
                <button class="btn btn-link w-100" @click="authVista = 'menu'">Volver</button>
            </div>

            <div v-if="authVista === 'registro'" class="w-100 p-4 border rounded">
                <h4>Registro</h4>
                <input type="text" v-model="formReg.nombre" class="form-control mb-2" placeholder="Nombre">
                <input type="email" v-model="formReg.email" class="form-control mb-2" placeholder="Email">
                <input type="text" v-model="formReg.iban" class="form-control mb-2" placeholder="IBAN (ES+22 dÃ­gitos)">
                <input type="password" v-model="formReg.pass" class="form-control mb-3" placeholder="ContraseÃ±a">
                <button class="btn btn-dark w-100" @click="ejecutarRegistro">Registrar</button>
                <button class="btn btn-link w-100" @click="authVista = 'menu'">Volver</button>
            </div>
        </div>
    </main>

    <footer class="bg-dark text-white text-center py-4">
        <p>&copy; 2024 Mundo Mascota S.L. | Calle Canina 123 | contacto@mascotas.es</p>
    </footer>
</div>

<script src="plantilla/js/script.js"></script>
</body>
</html>